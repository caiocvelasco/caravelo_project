version: 2

models:
  - name: vw_bookings_summary
    description: >
      Route-level summary by source system with segments, bookings, and passengers
      (segments ≈ seats sold on this leg).
    columns:
      - name: source_system
        description: "Data origin (Amadeus / Sabre / Vueling)."
      - name: origin
        description: "Route origin IATA."
      - name: destination
        description: "Route destination IATA."
      - name: segments
        description: "Count of passenger-flight rows (think 'seats sold on this leg')."
      - name: bookings
        description: "Distinct booking IDs (PNRs / Record Locators)."
      - name: passengers
        description: "Distinct passenger names (proxy for passenger count)."
  - name: dim_bookings
    description: "One row per booking (deduped across sources), with counts and metadata."
    columns:
      - name: booking_sk
        description: "Surrogate key = md5(source_system || '|' || booking_id)."
        tests: [not_null, unique]     # <— primary integrity tests
      - name: booking_id
        description: "Natural booking reference from source."
        tests: [not_null]
      - name: source_system
        description: "Originating system (Amadeus / Sabre / Vueling)."
        tests: [not_null]
